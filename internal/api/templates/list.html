{{define "title"}}Results{{end}}

{{define "content"}}
<h1 style="margin-bottom: 16px;">Test Results</h1>

<form class="filters" method="get" action="/results">
  <select name="plugin_id">
    <option value="">All Plugins</option>
    {{range .PluginIDs}}
    <option value="{{.}}" {{if eq . $.SelectedPluginID}}selected{{end}}>{{.}}</option>
    {{end}}
  </select>
  <select name="status">
    <option value="">All Statuses</option>
    {{range .Statuses}}
    <option value="{{.}}" {{if eq . $.SelectedStatus}}selected{{end}}>{{.}}</option>
    {{end}}
  </select>
  <button type="submit">Filter</button>
  {{if or .SelectedPluginID .SelectedStatus}}
  <a href="/results">Clear</a>
  {{end}}
</form>

{{if .Runs}}
<table>
  <thead>
    <tr>
      <th>Status</th>
      <th>Plugin</th>
      <th>Requested By</th>
      <th>Created</th>
      <th>Duration</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {{range .Runs}}
    <tr>
      <td><span class="badge badge-{{lower .Status}}">{{.Status}}</span></td>
      <td>{{.PluginID}}</td>
      <td>{{.RequestedBy}}</td>
      <td>{{formatTime .CreatedAt}}</td>
      <td>{{duration .StartedAt .FinishedAt}}</td>
      <td><a href="/results/{{.ID}}">View</a></td>
    </tr>
    {{end}}
  </tbody>
</table>

{{if gt .TotalPages 1}}
<div class="pagination">
  {{if gt .Page 1}}
  <a href="{{paginationURL $.SelectedPluginID $.SelectedStatus (sub .Page 1)}}">Prev</a>
  {{end}}
  <span class="current">Page {{.Page}} of {{.TotalPages}}</span>
  {{if lt .Page .TotalPages}}
  <a href="{{paginationURL $.SelectedPluginID $.SelectedStatus (add .Page 1)}}">Next</a>
  {{end}}
</div>
{{end}}

{{else}}
<div class="empty">No test runs found.</div>
{{end}}
{{end}}
